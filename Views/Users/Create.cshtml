@model AlertSystem.Models.Entities.User
@{
    ViewData["Title"] = "Créer un utilisateur";
    var departments = ViewBag.Departments as List<AlertSystem.Models.Entities.Department>;
}
<div class="container py-3">
  <h3>Créer un utilisateur</h3>
  <form asp-action="Create" method="post" class="mt-3">
    @Html.AntiForgeryToken()
    <div class="mb-3">
      <label class="form-label">Username</label>
      <input asp-for="Username" class="form-control" />
    </div>
    <div class="mb-3">
      <label class="form-label">Email</label>
      <input asp-for="Email" class="form-control" />
    </div>
    <div class="mb-3">
      <label class="form-label">Téléphone</label>
      <input asp-for="PhoneNumber" class="form-control" />
    </div>
    <div class="mb-3">
      <label class="form-label">Mot de passe</label>
      <input asp-for="PasswordHash" class="form-control" />
    </div>
    @if (User.IsInRole("Admin"))
    {
      <div class="mb-3">
        <label class="form-label">Rôle</label>
        <select asp-for="Role" class="form-select">
          <option value="Admin">Admin</option>
          <option value="SuperUser">SuperUser</option>
          <option value="User" selected>User</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Département</label>
        <select asp-for="DepartmentId" class="form-select">
          <option value="">-- Aucun --</option>
          @if (departments != null) {
              foreach (var d in departments) {
                  <option value="@d.DepartmentId">@d.Name</option>
              }
          }
        </select>
      </div>
    }
    else
    {
      <input type="hidden" asp-for="Role" value="User" />
      <input type="hidden" asp-for="DepartmentId" />
    }
    <div class="d-flex gap-2">
      <button class="btn btn-primary" type="submit">Enregistrer</button>
      <a class="btn btn-secondary" asp-action="Index">Annuler</a>
    </div>
  </form>
</div>


